<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Thank You</title>
		<link rel="stylesheet" href="styles.css" />
	</head>
	<body>
		<div class="container">
			<h1>ðŸŽ‰ Thank You for Your Purchase!</h1>
			<p>Weâ€™ve received your subscription and are preparing everything.</p>
			<p>
				<small>Youâ€™ll receive an email shortly with your next steps.</small>
			</p>
		</div>

		<script>
			// Helper to extract query params
			function getParams() {
				const params = new URLSearchParams(window.location.search);
				const obj = {};
				for (const [key, value] of params) {
					obj[key] = decodeURIComponent(value);
				}
				return obj;
			}

			async function logToAirtable() {
				const data = getParams();

				try {
					const res = await fetch('/.netlify/functions/logSubscription', {
						method: 'POST',
						body: JSON.stringify(data),
					});
					const result = await res.json();
					console.log('Logged to Airtable:', result);
				} catch (err) {
					console.error('Failed to log subscription', err);
				}
			}

			logToAirtable();
		</script>
	</body>
</html>
